function EditableGrid_loadChart(a){var b=findSWF(a);b&&"function"==typeof b.load?b.load(JSON.stringify(EditableGrid_pending_charts[a])):setTimeout("EditableGrid_loadChart('"+a+"');",100)}function EditableGrid_get_chart_data(a){return setTimeout("EditableGrid_loadChart('"+a+"');",100),JSON.stringify(EditableGrid_pending_charts[a])}var EditableGrid_pending_charts={};EditableGrid.prototype.checkChartLib_OFC=function(){return EditableGrid_check_lib=!1,"undefined"==typeof JSON.stringify?(alert("This method needs the JSON javascript library"),!1):"undefined"==typeof findSWF?(alert("This method needs the open flash chart javascript library (findSWF)"),!1):"undefined"==typeof ofc_chart?(alert("This method needs the open flash chart javascript library (ofc_chart)"),!1):"undefined"==typeof swfobject?(alert("This method needs the swfobject javascript library"),!1):!0},EditableGrid.prototype.renderBarChart_OFC=function(divId,title,labelColumnIndexOrName,options){with(this){if(EditableGrid_check_lib&&!checkChartLib_OFC())return!1;if(this.legend=null,this.bgColor="#ffffff",this.alpha=.9,this.limit=0,this.bar3d=!0,this.rotateXLabels=0,options)for(var p in options)this[p]=options[p];labelColumnIndexOrName=labelColumnIndexOrName||0;var cLabel=getColumnIndex(labelColumnIndexOrName),chart=new ofc_chart;chart.bg_colour=bgColor,chart.set_title({text:title||"",style:"{font-size: 20px; color:#0000ff; font-family: Verdana; text-align: center;}"});var columnCount=getColumnCount(),rowCount=getRowCount()-(ignoreLastRow?1:0);limit>0&&rowCount>limit&&(rowCount=limit);for(var maxvalue=0,c=0;columnCount>c;c++)if(isColumnBar(c)){var bar=new ofc_element(bar3d?"bar_3d":"bar");bar.alpha=alpha,bar.colour=smartColorsBar[chart.elements.length%smartColorsBar.length],bar.fill="transparent",bar.text=getColumnLabel(c);for(var r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){var value=getValueAt(r,c);value>maxvalue&&(maxvalue=value),bar.values.push(value)}chart.add_element(bar)}for(var ymax=10;maxvalue>ymax;)ymax*=10;for(var dec_step=ymax/10;ymax-dec_step>maxvalue;)ymax-=dec_step;for(var xLabels=[],r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){var label=getRowAttribute(r,"barlabel");xLabels.push(label?label:getValueAt(r,cLabel))}chart.x_axis={stroke:1,tick_height:10,colour:"#E2E2E2","grid-colour":"#E2E2E2",labels:{rotate:rotateXLabels,labels:xLabels},"3d":5},chart.y_axis={stroke:4,tick_length:3,colour:"#428BC7","grid-colour":"#E2E2E2",offset:0,steps:ymax/10,max:ymax},chart.x_legend={text:legend||getColumnLabel(labelColumnIndexOrName),style:"{font-size: 11px; color: #000033}"},chart.y_legend={text:"",style:"{font-size: 11px; color: #000033}"},updateChart(divId,chart)}},EditableGrid.prototype.renderStackedBarChart_OFC=function(divId,title,labelColumnIndexOrName,options){with(this){if(EditableGrid_check_lib&&!checkChartLib_OFC())return!1;if(this.legend=null,this.bgColor="#ffffff",this.alpha=.8,this.limit=0,this.rotateXLabels=0,options)for(var p in options)this[p]=options[p];labelColumnIndexOrName=labelColumnIndexOrName||0;var cLabel=getColumnIndex(labelColumnIndexOrName),chart=new ofc_chart;chart.bg_colour=bgColor,chart.set_title({text:title||"",style:"{font-size: 20px; color:#0000ff; font-family: Verdana; text-align: center;}"});var columnCount=getColumnCount(),rowCount=getRowCount()-(ignoreLastRow?1:0);limit>0&&rowCount>limit&&(rowCount=limit);var maxvalue=0,bar=new ofc_element("bar_stack");bar.alpha=alpha,bar.colours=smartColorsBar,bar.fill="transparent",bar.keys=[];for(var c=0;columnCount>c;c++)isColumnBar(c)&&bar.keys.push({colour:smartColorsBar[bar.keys.length%smartColorsBar.length],text:getColumnLabel(c),"font-size":"13"});for(var r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){for(var valueRow=[],valueStack=0,c=0;columnCount>c;c++)if(isColumnBar(c)){var value=getValueAt(r,c);value=isNaN(value)?0:value,valueStack+=value,valueRow.push(value)}valueStack>maxvalue&&(maxvalue=valueStack),bar.values.push(valueRow)}chart.add_element(bar);for(var ymax=10;maxvalue>ymax;)ymax*=10;for(var dec_step=ymax/10;ymax-dec_step>maxvalue;)ymax-=dec_step;for(var xLabels=[],r=0;rowCount>r;r++)"1"!=getRowAttribute(r,"skip")&&xLabels.push("aa "+getValueAt(r,cLabel));chart.x_axis={stroke:1,tick_height:10,colour:"#E2E2E2","grid-colour":"#E2E2E2",labels:{rotate:rotateXLabels,labels:xLabels},"3d":5},chart.y_axis={stroke:4,tick_length:3,colour:"#428BC7","grid-colour":"#E2E2E2",offset:0,steps:ymax/10,max:ymax},chart.x_legend={text:legend||getColumnLabel(labelColumnIndexOrName),style:"{font-size: 11px; color: #000033}"},chart.y_legend={text:"",style:"{font-size: 11px; color: #000033}"},updateChart(divId,chart)}},EditableGrid.prototype.renderPieChart_OFC=function(divId,title,valueColumnIndexOrName,labelColumnIndexOrName,options){with(this){if(EditableGrid_check_lib&&!checkChartLib_OFC())return!1;if(this.startAngle=0,this.bgColor="#ffffff",this.alpha=.5,this.limit=0,this.gradientFill=!0,options)for(var p in options)this[p]=options[p];var type=getColumnType(valueColumnIndexOrName);if("double"!=type&&"integer"!=type&&valueColumnIndexOrName!=labelColumnIndexOrName)return;labelColumnIndexOrName=labelColumnIndexOrName||0,title="undefined"==typeof title||null===title?getColumnLabel(valueColumnIndexOrName):title;var cValue=getColumnIndex(valueColumnIndexOrName),cLabel=getColumnIndex(labelColumnIndexOrName),chart=new ofc_chart;chart.bg_colour=bgColor,chart.set_title({text:title,style:"{font-size: 20px; color:#0000ff; font-family: Verdana; text-align: center;}"});var rowCount=getRowCount()-(ignoreLastRow?1:0);limit>0&&rowCount>limit&&(rowCount=limit);var pie=new ofc_element("pie");if(pie.colours=smartColorsPie,pie.alpha=alpha,pie["gradient-fill"]=gradientFill,"undefined"!=typeof startAngle&&null!==startAngle&&(pie["start-angle"]=startAngle),valueColumnIndexOrName==labelColumnIndexOrName){for(var distinctValues={},r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){var rowValue=getValueAt(r,cValue);rowValue in distinctValues?distinctValues[rowValue]++:distinctValues[rowValue]=1}for(var value in distinctValues){var occurences=distinctValues[value];pie.values.push({value:occurences,label:value+" ("+(100*(occurences/rowCount)).toFixed(1)+"%)"})}}else{for(var total=0,r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){var rowValue=getValueAt(r,cValue);total+=isNaN(rowValue)?0:rowValue}for(var r=0;rowCount>r;r++)if("1"!=getRowAttribute(r,"skip")){var value=getValueAt(r,cValue),label=getValueAt(r,cLabel);isNaN(value)||pie.values.push({value:value,label:label+" ("+(100*(value/total)).toFixed(1)+"%)"})}}return chart.add_element(pie),pie.values.length>0&&updateChart(divId,chart),pie.values.length}},EditableGrid.prototype.updateChart=function(divId,chart){if("undefined"==typeof this.ofcSwf||!this.ofcSwf){this.ofcSwf="open-flash-chart.swf";for(var e=document.getElementsByTagName("script"),i=0;i<e.length;i++){var index=e[i].src.indexOf("openflashchart");if(-1!=index){this.ofcSwf=e[i].src.substr(0,index+15)+this.ofcSwf;break}}}with(this){var swf=findSWF(divId);if(swf&&"function"==typeof swf.load)try{swf.load(JSON.stringify(chart))}catch(ex){console.error(ex)}else{var div=_$(divId);EditableGrid_pending_charts[divId]=chart;var w=parseInt(getStyle(div,"width")),h=parseInt(getStyle(div,"height"));w=Math.max(isNaN(w)?0:w,div.offsetWidth),h=Math.max(isNaN(h)?0:h,div.offsetHeight),swfobject.embedSWF(this.ofcSwf,divId,""+(w||500),""+(h||200),"9.0.0","expressInstall.swf",{"get-data":"EditableGrid_get_chart_data",id:divId},null,{wmode:"Opaque",salign:"l",AllowScriptAccess:"always"})}chartRendered()}};
//# sourceMappingURL=editablegrid_charts_ofc.min.js.map