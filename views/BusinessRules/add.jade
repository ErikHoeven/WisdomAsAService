extends ../../layouts/default

block head
  title Add Event
  //JS
  script(src='../../views/BusinessRules/jscolor-custom-look/jscolor.js')
  script(src='https://code.jquery.com/jquery-3.2.1.min.js')
  //script(src='../../views/BusinessRules/Simulatie.js')
  script.
      var lstCatValues = [];
      var lstParValues = [];

      $(document).ready(function(){
          // (1) Start situation
          $('#Kleurbepaler').hide();
          $('#zoekwaarde').show();
          $('#score').hide();
          $('#Cattegorie').hide();
          $('#CattegorieValue').hide();
          $('#Simulatie').hide();
          $('#Scraping').hide();
          $('#KamervanKoophandel').hide();
          $('#Dictionary').hide();
          $('#txtWoord').hide();
          $('#lstWoordvorm').hide()
          $('#lstWordCloudExceptions').hide()


          console.info('document geladen');


          // (2) listbox Change hide & show input fields
          $('#lstTypeBusinessRule').change(function(){

              if ($('#lstTypeBusinessRule option:selected').text() == 'Cattegorie') {
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').show();
                  $('#Kleurbepaler').show();
                  $('#CattegorieValue').show();
                  $('#Simulatie').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#lstWordCloudExceptions').hide()


              }
              if ($('#lstTypeBusinessRule option:selected').text() == 'Zoekwaarde') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').show();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#lstWordCloudExceptions').hide()

              }
              if ($('#lstTypeBusinessRule option:selected').text() == 'Score') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').show();
                  $('#score').show();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#lstWordCloudExceptions').hide()

              }
              if ($('#lstTypeBusinessRule option:selected').text() == 'Google zoekwaarde') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').show();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#lstWordCloudExceptions').hide()

              }

              if ($('#lstTypeBusinessRule option:selected').text() == 'Simulatie') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').show();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#Upload').hide();
                  $('#lstWordCloudExceptions').hide()

                  var formFields = getSimFormFields()

              }

              if ($('#lstTypeBusinessRule option:selected').text() == 'Kamer van Koophandel') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').show();
                  $('#Dictionary').hide();
                  $('#Upload').hide();
                  $('#lstWordCloudExceptions').hide()
              }

              if ($('#lstTypeBusinessRule option:selected').text() == 'Dictionary') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').show();
                  $('#Upload').hide();
                  $('#lstWordCloudExceptions').hide()
              }

              if ($('#lstTypeBusinessRule option:selected').text() == 'BuildGraph') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#Upload').hide();
                  $('#lstWordCloudExceptions').hide()
              }

              if ($('#lstTypeBusinessRule option:selected').text() == 'Upload') {
                  $('#Kleurbepaler').hide();
                  $('#zoekwaarde').hide();
                  $('#score').hide();
                  $('#Cattegorie').hide();
                  $('#CattegorieValue').hide();
                  $('#Simulatie').hide();
                  $('#lstSimAantalFormulieren').hide();
                  $('#Scraping').hide();
                  $('#KamervanKoophandel').hide();
                  $('#Dictionary').hide();
                  $('#Upload').show();
                  $('#lstWordCloudExceptions').hide()
              }

          });

          $('#lstActie').change(function(){
              if ($('#lstActie option:selected').text() == 'Zoeken') {
                  $('#txtWoord').hide();
                  $('#lstWoordvorm').hide()
              }

              if ($('#lstActie option:selected').text() == 'handmatig toevoegen') {
                  $('#txtWoord').show();
                  $('#lstWoordvorm').show();
              }
          })


          // (3) Add value to array
          $('#cmdAddCatValue').click(function(){
              lstCatValues.push($('#CatValue' ).val());
              $('#CatValue' ).val('');


              //START TABLE
              catValueHTML = '<p><table class="table table-sm"><th>Cattegorie waarde:</th>';


              for(var i = 0; i < lstCatValues.length; i++){
                  catValueHTML = catValueHTML + '<tr><td>'+ lstCatValues[i] +'</td></tr>'
              }

              catValueHTML = catValueHTML + '</tabel>'

              //END TABLE

              //START HIDDEN FIELD
              catValueHTML = catValueHTML + '<input type="hidden" id="catValue" name="catValue" value=' + JSON.stringify(lstCatValues) + '></input>'


              $('#catvaluelist').html(catValueHTML)
          });
          // (4)Clear array from step 3
          $('#clearCatValue').click(function(){
              lstCatValues = [];
              $('#catvaluelist').html('');
              $('#CatValue' ).val('');

          });
          var teller = 0;
          //
          $('#kleur').focusout(function () {
              teller = teller + 1;
              console.info(teller)
              if (teller == 1 ){
                  datasetvb = [];
                  datasetvb.push({
                      color: "#" + $(this).val()
                      , label: $('#txtTagCattegory').val()
                      , value: 50
                  });

                  datasetvb.push({
                      color: "#333333"
                      , label: "Overige"
                      , value: 100
                  });
                  console.info(datasetvb);
              }
          });

          $('#kleur').focusin(function () {
              teller = 0;
          });



      });
block body
  form(method='post', action='/BusinessRules')
    div.row
      div.col-sm-6
        div.page-header
          h1 Toevoegen BusinessRule
    div.row
      div.col-sm-6
        label Type Business Rule:
          select.form-control(name='lstTypeBusinessRule' id="lstTypeBusinessRule")
            option Zoekwaarde
            option Cattegorie
            option Score
            option Google zoekwaarde
            option Simulatie
            option Kamer van Koophandel
            option Dictionary
            option BuildGraph
            option Upload
            option WordCloudExceptions
      div.col-sm-6
        #pieDemo
    div.row
      div.col-sm-6
        div.form-group(id='zoekwaarde')
          label Zoek waarde:
            input.form-control(type='text', name='txtLookupValue')
    div.row
      div.col-sm-6
        div.form-group(id='Cattegorie')
          label Categorie:
            input.form-control(type='text', name='txtTagCattegory' id='txtTagCattegory')
    div.row
      div.col-sm-6
        div.form-group(id='CattegorieValue')
          label Cattegorie waarde:
            input.form-control(type='text', name='CatValueAdd' id='CatValue')
            button.btn.btn-info(type='button' id='cmdAddCatValue') Toevoegen
            button.btn.btn-info(type='button' id='clearCatValue') Schonen
            #catvaluelist
    div.row
      div.col-sm-6
        div.form-group(id='score')
          label Score:
            input.form-control(type='text', name='txtTagScore')
    div.row
      div.col-sm-6
        div.form-group(id='Kleurbepaler')
          label Kleur:
            input.form-control(type='text', value='0fa7c2' class="jscolor{width:101, padding:0, shadow:false, borderWidth:0, backgroundColor:'transparent', insetColor:'#000'}" name="kleur" id="kleur")

    div.form-group(id='KamervanKoophandel')
      div.row
        div.col-sm-3
          label Zoeken op
          input.form-control(type='text', name="txtZoekBedrijf" id="txtZoekBedrijf")
          label Aantal Paginas
          input.form-control(type='text', name="txtAantalPaginas" id="txtAantalPaginas")

    div.form-group(id='Dictionary')
      div.row
        div.col-sm-3
          label Actie:
          select.form-control(name='lstActie' id="lstActie")
            option Zoeken
            option Zoeken bijvoegelijknaamwoorden
            option handmatig toevoegen
          label Typewoord:
          select.form-control(name='lstWoordvorm' id="lstWoordvorm")
            option ZelfstandigNaamWoord
            option BijvoegelijkNaamWoord
            option Volledig werkwoord
            option Verledentijd
            option VoltooidDeelWoord
          label Woord
          input.form-control(type='text', name="txtWoord" id="txtWoord")
    script.

        $('#lstActie').change(function(){
            var valueListActie = $('#lstActie option:selected').text()
            console.info(valueListActie)
            if ( valueListActie == 'Zoeken bijvoegelijknaamwoorden') {
                $('#divCmdToevoegenBusinessRules').html('<button type="button" id="addBijvoegelijknaamwoorden" class="btn btn-primary">toevoegen Bijvoegelijknaamwoorden</button>')

                $('#addBijvoegelijknaamwoorden').click(function () {
                    console.info('Toevoegen bijvoegelijknaamwoorden')
                    $.ajax({
                        url: '/BusinessRules/sentiment',
                        type: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({message: 'Toevoegen woorden'}),
                        success: function (response) {
                            console.info(response)
                            //createGeneric(response, 'tblBusinessrules', 'trainingSet', 1, 'score', '_id', 'Training set for Sentiment Model')
                            //$('#trainingSetOptions').html('')
                            //$('#btnSentiment').html('<button type="button" id="cmdBuildModel" class="btn btn-primary">Build Sentiment Model</button>')
                        }
                    });
                })

            }
        })


    div.row
      div.col-sm-6
        div.form-group
          #divCmdToevoegenBusinessRules
            button.btn.btn-primary.btn-signup(type='submit' id='cmdToevoegenBusinessRules') Toevoegen aan rules


